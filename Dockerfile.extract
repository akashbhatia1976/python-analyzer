# ---------- PDF / OpenAI extractor image -----------------------------
FROM python:3.11-slim

# ---- system packages needed by pdf2image / poppler / tesseract -------
RUN apt-get update && \
    apt-get install -y \
        tesseract-ocr \
        libtesseract-dev \
        poppler-utils  \
        libjpeg-dev zlib1g-dev && \
    apt-get clean

# ---- copy only the files this service needs --------------------------
WORKDIR /app

#   1. requirements
COPY requirements.txt .

#   2. code + JSON mapping files
COPY main.py openai_extract_fields_combined.py ./
COPY data ./data                 # <-- include the JSONs!

RUN pip install --upgrade pip && pip install -r requirements.txt

# ---- expose the Flask port ------------------------------------------
EXPOSE 8081

CMD ["python", "main.py"]
